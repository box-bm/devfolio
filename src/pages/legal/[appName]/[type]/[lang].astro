---
import { getCollection } from "astro:content";
import LegalBase from "@layouts/Legal.astro";

export async function getStaticPaths() {
  const policies = await getCollection("legal");

  return policies.map((policy) => {
    const { type, lang } = policy.data;
    const [appName] = policy.slug.split("/");
    const normalizeAppName = appName.toLowerCase();

    return {
      params: {
        appName: normalizeAppName,
        type,
        lang,
      },
      props: {
        policy,
      },
    };
  });
}

const { policy } = Astro.props;
const { Content } = await policy.render();
---

<LegalBase title={policy.data.title}>
  <main class="legal-container">
    <h1>{policy.data.title}</h1>

    <p>
      App: <strong>{policy.data.app}</strong><br />
      Versi√≥n: {policy.data.version}<br />
      Vigente desde: {policy.data.effectiveDate.toLocaleDateString()}
    </p>

    <article>
      <Content />
    </article>
  </main>
</LegalBase>

<style>
  .legal-container {
    max-width: 800px;
    margin: 0 auto;
    padding: 24px;
    font-size: 1rem;
    line-height: 1.6;
  }

  .legal-container h1 {
    font-size: 2rem;
    margin-bottom: 16px;
  }

  .legal-container article {
    margin-top: 24px;
  }

  .legal-container p {
    margin-bottom: 16px;
  }
</style>
